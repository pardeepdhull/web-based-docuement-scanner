<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocuScan - Web-Based Document Scanner &amp; OCR</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÑ</text></svg>">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="logo">üìÑ</span>
            <span class="brand-name">DocuScan</span>
        </div>
        <div class="nav-links">
            <button class="nav-btn active" data-view="scan">
                <span class="nav-icon">üì∑</span>
                <span class="nav-text">Scan</span>
            </button>
            <button class="nav-btn" data-view="documents">
                <span class="nav-icon">üìÅ</span>
                <span class="nav-text">Documents</span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Scan View -->
        <section id="scan-view" class="view active">
            <div class="view-header">
                <h1>Add Document</h1>
                <p>Scan a document using your camera or upload an existing image</p>
            </div>
            
            <div class="scan-options">
                <div class="option-card" id="camera-option">
                    <div class="option-icon">üì∑</div>
                    <h3>Use Camera</h3>
                    <p>Scan document using your device camera</p>
                    <button class="btn btn-primary" id="start-camera-btn">Start Camera</button>
                </div>
                
                <div class="option-card" id="upload-option">
                    <div class="option-icon">üì§</div>
                    <h3>Upload File</h3>
                    <p>Upload an existing image file</p>
                    <input type="file" id="file-input" accept="image/*,.pdf" hidden>
                    <button class="btn btn-secondary" id="upload-btn">Choose File</button>
                </div>
            </div>

            <!-- Camera Container -->
            <div id="camera-container" class="camera-container hidden">
                <div class="camera-header">
                    <h3>Camera Preview</h3>
                    <button class="btn-icon" id="close-camera-btn" title="Close Camera">‚úï</button>
                </div>
                <div class="video-wrapper">
                    <video id="camera-video" autoplay playsinline></video>
                    <canvas id="capture-canvas" hidden></canvas>
                </div>
                <div class="camera-controls">
                    <button class="btn btn-primary btn-lg" id="capture-btn">
                        <span class="capture-icon">üì∏</span> Capture
                    </button>
                </div>
            </div>

            <!-- Image Preview -->
            <div id="preview-container" class="preview-container hidden">
                <div class="preview-header">
                    <h3>Document Preview</h3>
                    <button class="btn-icon" id="close-preview-btn" title="Cancel">‚úï</button>
                </div>
                <div class="preview-image-wrapper">
                    <img id="preview-image" src="" alt="Document Preview">
                </div>
                <div class="preview-form">
                    <div class="form-group">
                        <label for="doc-name">Document Name</label>
                        <input type="text" id="doc-name" placeholder="Enter document name" class="form-input">
                    </div>
                    <div class="preview-actions">
                        <button class="btn btn-secondary" id="retake-btn">Retake</button>
                        <button class="btn btn-primary" id="save-scan-btn">
                            <span class="btn-loader hidden"></span>
                            <span class="btn-text">Save &amp; Process OCR</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Documents View -->
        <section id="documents-view" class="view">
            <div class="view-header">
                <h1>My Documents</h1>
                <p>View and manage your scanned documents</p>
            </div>
            
            <div class="documents-toolbar">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="search-input" placeholder="Search documents..." class="search-input">
                </div>
                <div class="filter-options">
                    <select id="sort-select" class="form-select">
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="name-asc">Name (A-Z)</option>
                        <option value="name-desc">Name (Z-A)</option>
                    </select>
                </div>
            </div>

            <div id="documents-grid" class="documents-grid">
                <!-- Documents will be dynamically inserted here -->
            </div>

            <div id="no-documents" class="no-documents hidden">
                <div class="empty-icon">üìÑ</div>
                <h3>No Documents Yet</h3>
                <p>Start by scanning or uploading your first document</p>
                <button class="btn btn-primary" id="go-scan-btn">Scan Document</button>
            </div>
        </section>

        <!-- Document Viewer Modal -->
        <div id="viewer-modal" class="modal hidden">
            <div class="modal-content viewer-modal-content">
                <div class="modal-header">
                    <h2 id="viewer-title">Document Viewer</h2>
                    <button class="btn-icon modal-close" id="close-viewer-btn" title="Close">‚úï</button>
                </div>
                <div class="viewer-tabs">
                    <button class="tab-btn active" data-tab="image">Document</button>
                    <button class="tab-btn" data-tab="text">Extracted Text</button>
                    <button class="tab-btn" data-tab="split">Split View</button>
                </div>
                <div class="viewer-content">
                    <!-- Image View -->
                    <div id="image-tab" class="tab-content active">
                        <div class="image-viewer">
                            <img id="viewer-image" src="" alt="Document">
                        </div>
                    </div>
                    <!-- Text View -->
                    <div id="text-tab" class="tab-content">
                        <div class="text-viewer">
                            <div class="text-toolbar">
                                <button class="btn btn-sm" id="edit-text-btn" title="Edit Text">‚úèÔ∏è Edit</button>
                                <button class="btn btn-sm" id="copy-text-btn" title="Copy to Clipboard">üìã Copy</button>
                                <button class="btn btn-sm" id="download-text-btn" title="Download Text">‚¨áÔ∏è Download</button>
                            </div>
                            <div id="text-content" class="text-content" contenteditable="false"></div>
                        </div>
                    </div>
                    <!-- Split View -->
                    <div id="split-tab" class="tab-content">
                        <div class="split-viewer">
                            <div class="split-pane image-pane">
                                <img id="split-image" src="" alt="Document">
                            </div>
                            <div class="split-pane text-pane">
                                <div id="split-text-content" class="text-content"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger" id="delete-doc-btn">üóëÔ∏è Delete Document</button>
                    <button class="btn btn-secondary" id="reprocess-btn">üîÑ Re-process OCR</button>
                    <button class="btn btn-primary" id="save-text-btn" disabled>üíæ Save Changes</button>
                </div>
            </div>
        </div>

        <!-- Processing Modal -->
        <div id="processing-modal" class="modal hidden">
            <div class="modal-content processing-modal-content">
                <div class="processing-spinner"></div>
                <h3 id="processing-text">Processing...</h3>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <p id="progress-status">Initializing OCR engine...</p>
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirm-modal" class="modal hidden">
            <div class="modal-content confirm-modal-content">
                <div class="confirm-icon">‚ö†Ô∏è</div>
                <h3 id="confirm-title">Confirm Action</h3>
                <p id="confirm-message">Are you sure you want to proceed?</p>
                <div class="confirm-actions">
                    <button class="btn btn-secondary" id="confirm-cancel-btn">Cancel</button>
                    <button class="btn btn-danger" id="confirm-ok-btn">Delete</button>
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container"></div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>DocuScan - Web-Based Document Scanner &amp; OCR | No installation required</p>
    </footer>

    <!-- Tesseract.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <!-- PDF.js CDN for PDF support -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <!-- Application Scripts -->
    <script src="js/db.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
